{"version":3,"names":["currentWebview","_sfc_main","mixins","uni_modules_uniIdPages_common_loginPage_mixin","mixin","data","type","phone","focusPhone","logo","computed","loginTypes","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","wrap","_callee$","_context","prev","next","abrupt","uni_modules_uniIdPages_config","config","stop","isPhone","test","imgSrc","images","weixin","apple","huawei","huaweiMobile","onLoad","e","_this","_callee2","_callee2$","_context2","$nextTick","includes","$refs","uniFabLogin","servicesList","filter","item","id","common_vendor","index","$on","type2","onShow","onUnload","$off","onReady","methods","showCurrentWebview","setStyle","showAgreementModal","agreements","popup","quickLogin","options","__f__","_a","detail","code","phoneNumberCode","_b","login_before","toSmsPage","showToast","title","icon","duration","needAgreements","agree","navigateTo","url","toPwdLogin","chooseArea","wx","createPage","MiniProgramPage"],"sources":["login-withoutpwd.vue","dW5pX21vZHVsZXMvdW5pLWlkLXBhZ2VzL3BhZ2VzL2xvZ2luL2xvZ2luLXdpdGhvdXRwd2QudnVl"],"sourcesContent":["<!-- 免密登录页 -->\r\n<template>\r\n\t<view class=\"uni-content\">\r\n\t\t<view class=\"login-logo\">\r\n\t\t\t<image :src=\"logo\"></image>\r\n\t\t</view>\r\n\t\t<!-- 顶部文字 -->\r\n\t\t<text class=\"title\">请选择登录方式</text>\r\n\t\t<!-- 快捷登录框 当url带参数时有效 -->\r\n\t\t<template v-if=\"['apple','weixin', 'weixinMobile', 'huawei', 'huaweiMobile'].includes(type)\">\r\n\t\t\t<text class=\"tip\">将根据第三方账号服务平台的授权范围获取你的信息</text>\r\n\t\t\t<view class=\"quickLogin\">\r\n\t\t\t\t<image v-if=\"type !== 'weixinMobile' && type !== 'huaweiMobile'\" @click=\"quickLogin\" :src=\"imgSrc\" mode=\"widthFix\"\r\n\t\t\t\t\tclass=\"quickLoginBtn\"></image>\r\n\t\t\t\t<view v-else style=\"position: relative\">\r\n\t\t\t\t\t<button v-if=\"type ==='weixinMobile'\" type=\"primary\" open-type=\"getPhoneNumber\" @getphonenumber=\"quickLogin\"\r\n\t\t\t\t\t        class=\"uni-btn\">微信授权手机号登录</button>\r\n\t\t\t\t\t<button v-if=\"type === 'huaweiMobile'\" open-type=\"getPhoneNumber\" @getphonenumber=\"quickLogin\"\r\n\t\t\t\t\t        class=\"quickLoginBtn\" style=\"padding: 0; display: flex\">\r\n\t\t\t\t\t\t<image :src=\"imgSrc\" mode=\"widthFix\"></image>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<view v-if=\"this.needAgreements && !this.agree\" class=\"mobile-login-agreement-layer\" @click=\"showAgreementModal\"></view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<uni-id-pages-agreements scope=\"register\" ref=\"agreements\"></uni-id-pages-agreements>\r\n\t\t\t</view>\r\n\t\t</template>\r\n\t\t<template v-else>\r\n\t\t\t<text class=\"tip\">未注册的账号验证通过后将自动注册</text>\r\n\t\t\t<view class=\"phone-box\">\r\n\t\t\t\t<view @click=\"chooseArea\" class=\"area\">+86</view>\r\n\t\t\t\t<uni-easyinput trim=\"both\" :focus=\"focusPhone\" @blur=\"focusPhone = false\" class=\"input-box\" type=\"number\"\r\n\t\t\t\t\t:inputBorder=\"false\" v-model=\"phone\" maxlength=\"11\" placeholder=\"请输入手机号\" />\r\n\t\t\t</view>\r\n\t\t\t<uni-id-pages-agreements scope=\"register\" ref=\"agreements\"></uni-id-pages-agreements>\r\n\t\t\t<button class=\"uni-btn\" type=\"primary\" @click=\"toSmsPage\">获取验证码</button>\r\n\t\t</template>\r\n\t\t<!-- 固定定位的快捷登录按钮 -->\r\n\t\t<uni-id-pages-fab-login ref=\"uniFabLogin\"></uni-id-pages-fab-login>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\tlet currentWebview; //当前窗口对象\r\n\timport config from '@/uni_modules/uni-id-pages/config.js'\r\n\timport mixin from '@/uni_modules/uni-id-pages/common/login-page.mixin.js';\r\n\texport default {\r\n\t\tmixins: [mixin],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"\", //快捷登录方式\r\n\t\t\t\tphone: \"\", //手机号码\r\n\t\t\t\tfocusPhone: false,\r\n\t\t\t\tlogo: \"/static/logo.png\"\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tasync loginTypes() { //读取配置的登录优先级\r\n\t\t\t\treturn config.loginTypes\r\n\t\t\t},\r\n\t\t\tisPhone() { //手机号码校验正则\r\n\t\t\t\treturn /^1\\d{10}$/.test(this.phone);\r\n\t\t\t},\r\n\t\t\timgSrc() { //大快捷登录按钮图\r\n\t\t\t\tconst images = {\r\n\t\t\t\t\tweixin: '/uni_modules/uni-id-pages/static/login/weixin.png',\r\n\t\t\t\t\tapple: '/uni_modules/uni-id-pages/static/app/apple.png',\r\n\t\t\t\t\thuawei: '/uni_modules/uni-id-pages/static/login/huawei.png',\r\n\t\t\t\t\thuaweiMobile: '/uni_modules/uni-id-pages/static/login/huawei-mobile.png',\r\n\t\t\t\t}\r\n\t\t\t\treturn images[this.type]\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync onLoad(e) {\r\n\t\t\t//获取通过url传递的参数type设置当前登录方式，如果没传递直接默认以配置的登录\r\n\t\t\tlet type = e.type || config.loginTypes[0]\r\n\t\t\tthis.type = type\r\n\r\n\t\t\t// console.log(\"this.type: -----------\",this.type);\r\n\t\t\tif (type != 'univerify') {\r\n\t\t\t\tthis.focusPhone = true\r\n\t\t\t}\r\n\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t//关闭重复显示的登录快捷方式\r\n\t\t\t\tif (['weixin', 'apple', 'huawei', 'huaweiMobile'].includes(type)) {\r\n\t\t\t\t\tthis.$refs.uniFabLogin.servicesList = this.$refs.uniFabLogin.servicesList.filter(item =>\r\n\t\t\t\t\t\titem.id != type)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tuni.$on('uni-id-pages-setLoginType', type => {\r\n\t\t\t\tthis.type = type\r\n\t\t\t})\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\t// #ifdef H5\r\n\t\t\tdocument.onkeydown = event => {\r\n\t\t\t\tvar e = event || window.event;\r\n\t\t\t\tif (e && e.keyCode == 13) { //回车键的键值为13\r\n\t\t\t\t\tthis.toSmsPage()\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\tonUnload() {\r\n\t\t\tuni.$off('uni-id-pages-setLoginType')\r\n\t\t},\r\n\t\tonReady() {\r\n\t\t\t// 是否优先启动一键登录。即：页面一加载就启动一键登录\r\n\t\t\t//#ifdef APP-PLUS\r\n\t\t\tif (config.loginTypes.includes('univerify') && this.type == \"univerify\") {\r\n\t\t\t\tuni.preLogin({\r\n\t\t\t\t\tprovider: 'univerify',\r\n\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\tconst pages = getCurrentPages();\r\n\t\t\t\t\t\tcurrentWebview = pages[pages.length - 1].$getAppWebview();\r\n\t\t\t\t\t\tcurrentWebview.setStyle({\r\n\t\t\t\t\t\t\t\"top\": \"2000px\" // 隐藏当前页面窗体\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// this.type == this.loginTypes[1]\r\n\t\t\t\t\t\t// console.log('开始一键登录');\r\n\t\t\t\t\t\tthis.$refs.uniFabLogin.login_before('univerify')\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\tif (config.loginTypes.length > 1) {\r\n\t\t\t\t\t\t\tthis.$refs.uniFabLogin.login_before(config.loginTypes[1])\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\tcontent: err.message,\r\n\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\t//#endif\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tshowCurrentWebview(){\r\n\t\t\t\t// 恢复当前页面窗体的显示 一键登录，默认不显示当前窗口\r\n\t\t\t\tcurrentWebview.setStyle({\r\n\t\t\t\t\t\"top\": 0\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tshowAgreementModal () {\r\n\t\t\t\tthis.$refs.agreements.popup()\r\n\t\t\t},\r\n\t\t\tquickLogin(e) {\r\n\t\t\t\tlet options = {}\r\n\t\t\t\tconsole.log(e)\r\n\t\t\t\tif (e.detail?.code) {\r\n\t\t\t\t\toptions.phoneNumberCode = e.detail.code\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ((this.type === 'weixinMobile' || this.type === 'huaweiMobile') && !e.detail?.code) return\r\n\r\n\t\t\t\tthis.$refs.uniFabLogin.login_before(this.type, true, options)\r\n\t\t\t},\r\n\t\t\ttoSmsPage() {\r\n\t\t\t\tif (!this.isPhone) {\r\n\t\t\t\t\tthis.focusPhone = true\r\n\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\ttitle: \"手机号码格式不正确\",\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 3000\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif (this.needAgreements && !this.agree) {\r\n\t\t\t\t\treturn this.$refs.agreements.popup(this.toSmsPage)\r\n\t\t\t\t}\r\n\t\t\t\t// 发送验证吗\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/uni_modules/uni-id-pages/pages/login/login-smscode?phoneNumber=' + this.phone\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t//去密码登录页\r\n\t\t\ttoPwdLogin() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '../login/password'\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tchooseArea() {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '暂不支持其他国家',\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\tduration: 3000\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t@import \"@/uni_modules/uni-id-pages/common/login-page.scss\";\r\n\r\n\t@media screen and (min-width: 690px) {\r\n\t\t.uni-content {\r\n\t\t\theight: 350px;\r\n\t\t}\r\n\t}\r\n\r\n\t.mobile-login-agreement-layer {\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\t.uni-content,\r\n\t.quickLogin {\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\t/* #endif */\r\n\t}\r\n\r\n\t.phone-box {\r\n\t\tposition: relative;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t}\r\n\r\n\t.area {\r\n\t\tposition: absolute;\r\n\t\tleft: 10px;\r\n\t\tz-index: 9;\r\n\t\ttop: 12px;\r\n\t\tfont-size: 14px;\r\n\t}\r\n\r\n\t.area::after {\r\n\t\tcontent: \"\";\r\n\t\tborder: 3px solid transparent;\r\n\t\tborder-top-color: #000;\r\n\t\ttop: 12px;\r\n\t\tleft: 3px;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t/* #ifdef MP */\r\n\t// 解决小程序端开启虚拟节点virtualHost引起的 class = input-box丢失的问题 [详情参考](https://uniapp.dcloud.net.cn/matter.html#%E5%90%84%E5%AE%B6%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6%E4%B8%8D%E5%90%8C-%E5%8F%AF%E8%83%BD%E5%AD%98%E5%9C%A8%E7%9A%84%E5%B9%B3%E5%8F%B0%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98)\r\n\t.phone-box ::v-deep .uni-easyinput__content,\r\n\t/* #endif */\r\n\t.input-box {\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tbox-sizing: border-box;\r\n\t\t/* #endif */\r\n\t\tflex: 1;\r\n\t\tpadding-left: 45px;\r\n\t\tmargin-bottom: 10px;\r\n\t\tborder-radius: 0;\r\n\t}\r\n\r\n\t.quickLogin {\r\n\t\theight: 350px;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.quickLoginBtn {\r\n\t\tmargin: 20px 0;\r\n\t\twidth: 450rpx;\r\n\t\tbackground-color: transparent;\r\n\t\tborder: none;\r\n\t\tbox-shadow: none;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tmax-width: 230px;\r\n\t\t/* #endif */\r\n\t\theight: 82rpx;\r\n\t}\r\n\r\n\t.tip {\r\n\t\tmargin-top: -15px;\r\n\t\tmargin-bottom: 20px;\r\n\t}\r\n\r\n\t@media screen and (min-width: 690px) {\r\n\t\t.quickLogin {\r\n\t\t\theight: auto;\r\n\t\t}\r\n\t}\r\n</style>\r\n","import MiniProgramPage from 'D:/2大花/毕业设计/Compus/uni_modules/uni-id-pages/pages/login/login-withoutpwd.vue'\nwx.createPage(MiniProgramPage)"],"mappings":"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","ignoreList":[]}