{"version":3,"file":"pinned-datail.js","sources":["pages/circle/pinned-datail/pinned-datail.vue","../../../Software/hbuilder/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2lyY2xlL3Bpbm5lZC1kYXRhaWwvcGlubmVkLWRhdGFpbC52dWU"],"sourcesContent":["<template>\n\t<view class=\"pinned-detail-container\">\n\t\t<!-- 加载状态 -->\n\t\t<view v-if=\"loading\" class=\"loading-overlay\">\n\t\t\t<view class=\"loading-spinner\"></view>\n\t\t</view>\n\n\t\t<!-- 内容区域 -->\n\t\t<scroll-view v-else class=\"content-scroll\" scroll-y=\"true\">\n\t\t\t<!-- 发布者信息 -->\n\t\t\t<view class=\"poster-info poster-card\">\n\t\t\t\t<view class=\"poster-avatar-bg\">\n\t\t\t\t\t<image class=\"avatar\" :src=\"post.avatar\" mode=\"aspectFill\"></image>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"poster-meta\">\n\t\t\t\t\t<view class=\"meta-row\">\n\t\t\t\t\t\t<text class=\"poster-name\">{{post.name}}</text>\n\t\t\t\t\t\t<view class=\"poster-tag\" :class=\"post.type === '官方' ? 'official' : 'merchant'\">{{post.type}}</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<text class=\"poster-time\">{{post.time}}</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 内容主体 -->\n\t\t\t<view class=\"content-body p-base bg-white mt-sm\">\n\t\t\t\t<text class=\"content-text\">{{post.content}}</text>\n\t\t\t\t\n\t\t\t\t<!-- 图片展示 -->\n\t\t\t\t<view class=\"image-grid\" v-if=\"post.images && post.images.length\">\n\t\t\t\t\t<image \n\t\t\t\t\t\tv-for=\"(img, index) in post.images\" \n\t\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t\t:src=\"img\"\n\t\t\t\t\t\tmode=\"aspectFill\"\n\t\t\t\t\t\t@tap=\"previewImage(index)\"\n\t\t\t\t\t></image>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 互动区域 -->\n\t\t\t<view class=\"interaction-bar p-base bg-white mt-sm flex-between\">\n\t\t\t\t<view class=\"flex items-center\">\n\t\t\t\t\t<view class=\"interaction-item\" @tap=\"handleLike\">\n\t\t\t\t\t\t<text class=\"iconfont icon-dianzan like-btn\"\n\t\t\t\t\t\t\t:class=\"{'like-animate': post.likeAnimate, 'liked': post.isLiked}\"\n\t\t\t\t\t\t\t@tap=\"handleLike\"></text>\n\t\t\t\t\t\t<text class=\"count ml-xs\" :class=\"{'liked': post.isLiked}\">{{post.likes}}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"interaction-item ml-lg\" @tap=\"focusComment\">\n\t\t\t\t\t\t<text class=\"iconfont icon-icon_comment\"></text>\n\t\t\t\t\t\t<text class=\"count ml-xs\">{{post.comments}}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"interaction-item\" @tap=\"handleShare\">\n\t\t\t\t\t<text class=\"iconfont icon-fenxiang\"></text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 评论区 -->\n\t\t\t<view class=\"comments-section bg-white mt-sm\">\n\t\t\t\t<view class=\"section-title p-base border-bottom\">\n\t\t\t\t\t<text class=\"font-bold\">评论 {{post.comments}}</text>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- 评论列表 -->\n\t\t\t\t<view class=\"comment-list\">\n\t\t\t\t\t<view class=\"comment-item\" v-for=\"comment in comments\" :key=\"comment._id\">\n\t\t\t\t\t\t<image class=\"comment-avatar\" :src=\"comment.author_avatar\" mode=\"aspectFill\"></image>\n\t\t\t\t\t\t<view class=\"comment-content\">\n\t\t\t\t\t\t\t<view class=\"flex items-center\">\n\t\t\t\t\t\t\t\t<text class=\"comment-name font-bold\">{{ comment.author_name }}</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<text class=\"comment-text mt-xs\">{{ comment.content }}</text>\n\t\t\t\t\t\t\t<view class=\"comment-actions-bar flex mt-xs\">\n\t\t\t\t\t\t\t\t<view class=\"left-actions flex items-center\">\n\t\t\t\t\t\t\t\t\t<text class=\"comment-time text-muted text-xs\">{{ formatTime(comment.create_time) }}</text>\n\t\t\t\t\t\t\t\t\t<text class=\"action-btn ml-base\" @tap=\"replyToComment(comment)\">回复</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t<view class=\"right-actions flex items-center ml-auto\">\n\t\t\t\t\t\t\t\t\t<view class=\"like-btn-wrapper flex items-center\">\n\t\t\t\t\t\t\t\t\t\t<text class=\"iconfont like-btn\"\n\t\t\t\t\t\t\t\t\t\t\t:class=\"[comment.liked ? 'icon-aixin4 liked' : 'icon-aixin3', comment.likeAnimate ? 'like-animate' : '']\"\n\t\t\t\t\t\t\t\t\t\t\t@tap=\"likeComment(comment)\"></text>\n\t\t\t\t\t\t\t\t\t\t<text class=\"like-count ml-xs\" :class=\"{'liked': comment.liked}\">{{ comment.like_count }}</text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<!-- 子评论展示 -->\n\t\t\t\t\t\t\t<view v-if=\"comment.replies && comment.replies.length\" class=\"reply-list\">\n\t\t\t\t\t\t\t\t<view class=\"reply-item\" v-for=\"reply in comment.replies\" :key=\"reply._id\">\n\t\t\t\t\t\t\t\t\t<image class=\"reply-avatar\" :src=\"reply.author_avatar\" mode=\"aspectFill\"></image>\n\t\t\t\t\t\t\t\t\t<view class=\"reply-content\">\n\t\t\t\t\t\t\t\t\t\t<view class=\"flex items-center\">\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"reply-name\">{{ reply.author_name }}</text>\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"reply-time ml-xs\">{{ formatTime(reply.create_time) }}</text>\n\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t<text class=\"reply-text mt-xs\">{{ reply.content }}</text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</scroll-view>\n\t\t\n\t\t<!-- 底部评论输入框 -->\n\t\t<view class=\"comment-input-bar p-base bg-white\">\n\t\t\t<input \n\t\t\t\tclass=\"comment-input\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tv-model=\"commentText\"\n\t\t\t\t:placeholder=\"replyTo ? '回复 @' + replyTo.author_name + '：' : '说点什么...'\"\n\t\t\t\t:focus=\"isInputFocused\"\n\t\t\t\t@focus=\"onInputFocus\"\n\t\t\t\t@blur=\"onInputBlur\"\n\t\t\t/>\n\t\t\t<button class=\"send-btn\" :disabled=\"!commentText\" @tap=\"sendComment\">发送</button>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nexport default {\n\tdata() {\n\t\tconst userInfo = uni.getStorageSync('uni-id-pages-userInfo') || {};\n\t\treturn {\n\t\t\tpost: {\n\t\t\t\t_id: '',\n\t\t\t\tcontent: '',\n\t\t\t\timages: [],\n\t\t\t\tlikes: 0,\n\t\t\t\tcomments: 0,\n\t\t\t\ttime: '',\n\t\t\t\tname: '',\n\t\t\t\tavatar: '/static/images/default-avatar.png',\n\t\t\t\ttype: '官方',\n\t\t\t\tisLiked: false\n\t\t\t},\n\t\t\tcomments: [],\n\t\t\tcommentText: '',\n\t\t\tisInputFocused: false,\n\t\t\tlikeLoading: false,\n\t\t\tuserInfo: userInfo,\n\t\t\treplyTo: null,\n\t\t\treplyPlaceholder: '说点什么...',\n\t\t\tloading: true // 添加loading状态\n\t\t};\n\t},\n\tasync onLoad(options) {\n\t\tconst postId = options.id;\n\t\t// 并行加载数据\n\t\tawait Promise.all([\n\t\t\tthis.loadPostDetail(postId),\n\t\t\tthis.fetchComments(postId)\n\t\t]);\n\t\tthis.loading = false;\n\t},\n\t// 添加页面返回时的处理\n\tonUnload() {\n\t\t// 获取页面实例\n\t\tconst pages = getCurrentPages();\n\t\tconst circlePage = pages.find(page => page.route === 'pages/circle/circle');\n\t\tif (circlePage) {\n\t\t\t// 调用圈子页面的刷新方法\n\t\t\tcirclePage.$vm.fetchPinnedPosts();\n\t\t}\n\t},\n\tmethods: {\n\t\tgoBack() {\n\t\t\tuni.navigateBack();\n\t\t},\n\t\tpreviewImage(index) {\n\t\t\tuni.previewImage({\n\t\t\t\turls: this.post.images,\n\t\t\t\tcurrent: index\n\t\t\t});\n\t\t},\n\t\t// 获取帖子详情+用户信息+点赞状态\n\t\tasync loadPostDetail(postId) {\n\t\t\ttry {\n\t\t\t\t// 并行请求数据\n\t\t\t\tconst [postRes, userLikeRes] = await Promise.all([\n\t\t\t\t\t// 1. 获取置顶帖子详情\n\t\t\t\t\tuniCloud.database().collection('add-content')\n\t\t\t\t\t\t.where({ _id: postId, content_type: 'pinned' })\n\t\t\t\t\t\t.get(),\n\t\t\t\t\t// 2. 获取当前用户点赞状态\n\t\t\t\t\tthis.userInfo._id ? uniCloud.database().collection('user-likes')\n\t\t\t\t\t\t.where({\n\t\t\t\t\t\t\tuser_id: this.userInfo._id,\n\t\t\t\t\t\t\tpost_id: postId\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.get() : Promise.resolve({ result: { data: [] } })\n\t\t\t\t]);\n\n\t\t\t\tif (!postRes.result.data || postRes.result.data.length === 0) {\n\t\t\t\t\tuni.showToast({ title: '未找到该帖子', icon: 'none' });\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst post = postRes.result.data[0];\n\t\t\t\tconst isLiked = userLikeRes.result.data.length > 0;\n\n\t\t\t\t// 3. 获取发帖人信息\n\t\t\t\tlet user = {};\n\t\t\t\ttry {\n\t\t\t\t\tconst userRes = await uniCloud.database().collection('uni-id-users')\n\t\t\t\t\t\t.doc(post.user_id)\n\t\t\t\t\t\t.field('_id,avatar_file,nickname')\n\t\t\t\t\t\t.get();\n\t\t\t\t\tuser = userRes.result.data[0] || {};\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('获取发帖人信息失败:', e);\n\t\t\t\t}\n\n\t\t\t\t// 4. 组装数据\n\t\t\t\tthis.post = {\n\t\t\t\t\t_id: post._id,\n\t\t\t\t\tcontent: post.content,\n\t\t\t\t\timages: post.files || [],\n\t\t\t\t\tlikes: post.like_count || 0,\n\t\t\t\t\tcomments: post.comment_count || 0,\n\t\t\t\t\ttime: this.formatTime(post.create_time),\n\t\t\t\t\tname: user.nickname || '匿名用户',\n\t\t\t\t\tavatar: user.avatar_file && user.avatar_file.url ? user.avatar_file.url : '/static/images/default-avatar.png',\n\t\t\t\t\ttype: post.category || '官方',\n\t\t\t\t\tisLiked\n\t\t\t\t};\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error('获取帖子详情失败:', e);\n\t\t\t\tuni.showToast({ title: '加载失败', icon: 'none' });\n\t\t\t}\n\t\t},\n\t\t// 点赞帖子\n\t\tasync handleLike() {\n\t\t\tif (this.likeLoading) return;\n\t\t\tthis.likeLoading = true;\n\n\t\t\tif (!this.userInfo || !this.userInfo._id) {\n\t\t\t\tuni.showToast({ title: '请先登录', icon: 'none' });\n\t\t\t\tthis.likeLoading = false;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst userId = this.userInfo._id;\n\t\t\tconst postId = this.post._id;\n\n\t\t\ttry {\n\t\t\t\t// 先检查是否已点赞\n\t\t\t\tconst likeRes = await uniCloud.database().collection('user-likes')\n\t\t\t\t\t.where({\n\t\t\t\t\t\tuser_id: userId,\n\t\t\t\t\t\tpost_id: postId\n\t\t\t\t\t})\n\t\t\t\t\t.get();\n\n\t\t\t\tif (likeRes.result.data.length > 0) {\n\t\t\t\t\t// 已点赞，执行取消点赞\n\t\t\t\t\tconst likeId = likeRes.result.data[0]._id;\n\t\t\t\t\tawait uniCloud.database().collection('user-likes').doc(likeId).remove();\n\t\t\t\t\tawait uniCloud.database().collection('add-content').doc(postId).update({\n\t\t\t\t\t\tlike_count: this.post.likes - 1\n\t\t\t\t\t});\n\t\t\t\t\tthis.post.isLiked = false;\n\t\t\t\t\tthis.post.likes -= 1;\n\t\t\t\t\tuni.showToast({ title: '已取消点赞', icon: 'none' });\n\t\t\t\t} else {\n\t\t\t\t\t// 未点赞，执行点赞\n\t\t\t\t\tawait uniCloud.database().collection('user-likes').add({\n\t\t\t\t\t\tuser_id: userId,\n\t\t\t\t\t\tpost_id: postId,\n\t\t\t\t\t\tcreate_time: Date.now()\n\t\t\t\t\t});\n\t\t\t\t\tawait uniCloud.database().collection('add-content').doc(postId).update({\n\t\t\t\t\t\tlike_count: this.post.likes + 1\n\t\t\t\t\t});\n\t\t\t\t\tthis.post.isLiked = true;\n\t\t\t\t\tthis.post.likes += 1;\n\t\t\t\t\tuni.showToast({ title: '已点赞', icon: 'none' });\n\t\t\t\t}\n\n\t\t\t\t// 更新圈子页面的置顶帖子数据\n\t\t\t\tconst pages = getCurrentPages();\n\t\t\t\tconst circlePage = pages.find(page => page.route === 'pages/circle/circle');\n\t\t\t\tif (circlePage) {\n\t\t\t\t\tconst pinnedPosts = circlePage.$vm.pinnedPosts;\n\t\t\t\t\tconst targetPost = pinnedPosts.find(p => p._id === postId);\n\t\t\t\t\tif (targetPost) {\n\t\t\t\t\t\ttargetPost.likes = this.post.likes;\n\t\t\t\t\t\ttargetPost.isLiked = this.post.isLiked;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error('handleLike - 点赞操作失败:', e);\n\t\t\t\tuni.showToast({ title: '操作失败', icon: 'none' });\n\t\t\t} finally {\n\t\t\t\tthis.likeLoading = false;\n\t\t\t}\n\t\t},\n\t\tfocusComment() {\n\t\t\tthis.isInputFocused = true;\n\t\t},\n\t\thandleShare() {\n\t\t\tuni.showShareMenu({\n\t\t\t\twithShareTicket: true\n\t\t\t});\n\t\t},\n\t\tonInputFocus() {\n\t\t\tthis.isInputFocused = true;\n\t\t},\n\t\tonInputBlur() {\n\t\t\tthis.isInputFocused = false;\n\t\t},\n\t\t// 评论\n\t\tasync fetchComments(postId) {\n\t\t\ttry {\n\t\t\t\t// 并行获取评论数据和点赞状态\n\t\t\t\tconst [commentsRes, commentLikesRes] = await Promise.all([\n\t\t\t\t\tuniCloud.database().collection('user-comment')\n\t\t\t\t\t\t.where({ target_id: postId })\n\t\t\t\t\t\t.orderBy('create_time', 'asc')\n\t\t\t\t\t\t.get(),\n\t\t\t\t\tthis.userInfo._id ? uniCloud.database().collection('user-commentlikes')\n\t\t\t\t\t\t.where({\n\t\t\t\t\t\t\tuser_id: this.userInfo._id,\n\t\t\t\t\t\t\tcomment_id: uniCloud.database().command.in(\n\t\t\t\t\t\t\t\t(await uniCloud.database().collection('user-comment')\n\t\t\t\t\t\t\t\t\t.where({ target_id: postId })\n\t\t\t\t\t\t\t\t\t.get()).result.data.map(c => c._id)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.get() : Promise.resolve({ result: { data: [] } })\n\t\t\t\t]);\n\n\t\t\t\tconst all = commentsRes.result.data;\n\t\t\t\tconst likedMap = {};\n\t\t\t\tcommentLikesRes.result.data.forEach(like => {\n\t\t\t\t\tlikedMap[like.comment_id] = true;\n\t\t\t\t});\n\n\t\t\t\t// 一级评论\n\t\t\t\tconst top = all.filter(c => !c.parent_id).map(item => ({\n\t\t\t\t\t...item,\n\t\t\t\t\tuser_id: item.author_id,\n\t\t\t\t\tliked: likedMap[item._id] || false\n\t\t\t\t}));\n\n\t\t\t\t// 二级评论分组\n\t\t\t\ttop.forEach(parent => {\n\t\t\t\t\tparent.replies = all.filter(c => c.parent_id === parent._id).map(item => ({\n\t\t\t\t\t\t...item,\n\t\t\t\t\t\tuser_id: item.author_id,\n\t\t\t\t\t\tliked: likedMap[item._id] || false\n\t\t\t\t\t}));\n\t\t\t\t});\n\n\t\t\t\tthis.comments = top;\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error('获取评论失败:', e);\n\t\t\t\tuni.showToast({ title: '获取评论失败', icon: 'none' });\n\t\t\t}\n\t\t},\n\t\t// 发送评论\n\t\tasync sendComment() {\n\t\t\tif (!this.commentText.trim()) return;\n\t\t\tif (!this.userInfo._id) {\n\t\t\t\tuni.showToast({ title: '请先登录', icon: 'none' });\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst postId = this.post._id;\n\t\t\ttry {\n\t\t\t\tawait uniCloud.callFunction({\n\t\t\t\t\tname: 'user-comment',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tcontent: this.commentText,\n\t\t\t\t\t\tauthor_id: this.userInfo._id,\n\t\t\t\t\t\tauthor_name: this.userInfo.nickname || '匿名用户',\n\t\t\t\t\t\tauthor_avatar: this.userInfo.avatar_file && this.userInfo.avatar_file.url ? this.userInfo.avatar_file.url : '/static/images/default-avatar.png',\n\t\t\t\t\t\ttarget_id: postId,\n\t\t\t\t\t\tparent_id: this.replyTo ? this.replyTo._id : ''\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.commentText = '';\n\t\t\t\tthis.isInputFocused = false;\n\t\t\t\tthis.replyTo = null;\n\t\t\t\tthis.replyPlaceholder = '说点什么...';\n\t\t\t\tuni.showToast({ title: '评论成功', icon: 'none' });\n\t\t\t\tawait this.fetchComments(postId);\n\t\t\t\tthis.post.comments += 1;\n\t\t\t\t\n\t\t\t\t// 更新帖子评论数\n\t\t\t\tawait uniCloud.database().collection('add-content')\n\t\t\t\t\t.doc(postId)\n\t\t\t\t\t.update({\n\t\t\t\t\t\tcomment_count: this.post.comments\n\t\t\t\t\t});\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error('发送评论失败:', e);\n\t\t\t\tuni.showToast({ title: '评论失败', icon: 'none' });\n\t\t\t}\n\t\t},\n\t\tasync likeComment(comment) {\n\t\t\tif (comment.likeLoading) return;\n\t\t\tcomment.likeLoading = true;\n\t\t\tconst userId = this.userInfo._id;\n\t\t\tif (!userId) {\n\t\t\t\tuni.showToast({ title: '请先登录', icon: 'none' });\n\t\t\t\tcomment.likeLoading = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tif (comment.liked) {\n\t\t\t\t\t// 取消点赞\n\t\t\t\t\tconst likeRes = await uniCloud.database().collection('user-commentlikes')\n\t\t\t\t\t\t.where({\n\t\t\t\t\t\t\tuser_id: userId,\n\t\t\t\t\t\t\tcomment_id: comment._id\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.get();\n\n\t\t\t\t\tif (likeRes.result.data.length > 0) {\n\t\t\t\t\t\tconst likeId = likeRes.result.data[0]._id;\n\t\t\t\t\t\tawait uniCloud.database().collection('user-commentlikes')\n\t\t\t\t\t\t\t.doc(likeId)\n\t\t\t\t\t\t\t.remove();\n\n\t\t\t\t\t\t// 更新评论点赞数\n\t\t\t\t\t\tawait uniCloud.database().collection('user-comment')\n\t\t\t\t\t\t\t.doc(comment._id)\n\t\t\t\t\t\t\t.update({\n\t\t\t\t\t\t\t\tlike_count: (comment.like_count || 0) - 1\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// 扣除评论作者积分\n\t\t\t\t\t\tawait uniCloud.database().collection('user-score')\n\t\t\t\t\t\t\t.add({\n\t\t\t\t\t\t\t\tuser_id: comment.author_id,\n\t\t\t\t\t\t\t\tscore: -2,\n\t\t\t\t\t\t\t\ttype: 'comment_like',\n\t\t\t\t\t\t\t\tdescription: '评论被取消点赞',\n\t\t\t\t\t\t\t\trelated_id: comment._id,\n\t\t\t\t\t\t\t\tcreate_time: Date.now()\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\tcomment.liked = false;\n\t\t\t\t\t\tcomment.like_count = (comment.like_count || 0) - 1;\n\t\t\t\t\t\tuni.showToast({ title: '已取消点赞', icon: 'none' });\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// 添加点赞\n\t\t\t\t\tawait uniCloud.database().collection('user-commentlikes')\n\t\t\t\t\t\t.add({\n\t\t\t\t\t\t\tuser_id: userId,\n\t\t\t\t\t\t\tcomment_id: comment._id,\n\t\t\t\t\t\t\tcreate_time: Date.now()\n\t\t\t\t\t\t});\n\n\t\t\t\t\t// 更新评论点赞数\n\t\t\t\t\tawait uniCloud.database().collection('user-comment')\n\t\t\t\t\t\t.doc(comment._id)\n\t\t\t\t\t\t.update({\n\t\t\t\t\t\t\tlike_count: (comment.like_count || 0) + 1\n\t\t\t\t\t\t});\n\n\t\t\t\t\t// 给评论作者增加积分\n\t\t\t\t\tawait uniCloud.database().collection('user-score')\n\t\t\t\t\t\t.add({\n\t\t\t\t\t\t\tuser_id: comment.author_id,\n\t\t\t\t\t\t\tscore: 2,\n\t\t\t\t\t\t\ttype: 'comment_like',\n\t\t\t\t\t\t\tdescription: '评论获赞',\n\t\t\t\t\t\t\trelated_id: comment._id,\n\t\t\t\t\t\t\tcreate_time: Date.now()\n\t\t\t\t\t\t});\n\n\t\t\t\t\tcomment.liked = true;\n\t\t\t\t\tcomment.like_count = (comment.like_count || 0) + 1;\n\t\t\t\t\tuni.showToast({ title: '已点赞', icon: 'none' });\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error('点赞操作失败:', err);\n\t\t\t\tuni.showToast({ title: '操作失败', icon: 'none' });\n\t\t\t} finally {\n\t\t\t\tcomment.likeLoading = false;\n\t\t\t}\n\t\t},\n\t\treplyToComment(comment) {\n\t\t\tthis.replyTo = comment;\n\t\t\tthis.replyPlaceholder = `回复 @${comment.author_name}：`;\n\t\t\tthis.isInputFocused = true;1\n\t\t},\n\t\tformatTime(ts) {\n\t\t\tconst date = new Date(ts);\n\t\t\treturn `${date.getFullYear()}-${date.getMonth()+1}-${date.getDate()} ${date.getHours()}:${date.getMinutes()}`;\n\t\t}\n\t}\n};\n</script>\n\n<style lang=\"scss\">\n@import '@/styles/variables.scss';\n@import '@/styles/common.scss';\n\n.pinned-detail-container {\n\tmin-height: 100vh;\n\tbackground: #F8F9FC;\n\tpadding-bottom: 120rpx;\n}\n\n.content-scroll {\n\tflex: 1;\n\theight: calc(100vh - 180rpx);\n\tpadding-bottom: 160rpx;\n}\n\n.poster-info.poster-card {\n\tdisplay: flex;\n\talign-items: center;\n\tbackground: #fff;\n\tborder-radius: 18rpx;\n\tbox-shadow: 0 4rpx 16rpx rgba(231,215,122,0.06);\n\tpadding: 24rpx 24rpx 24rpx 24rpx;\n\tmargin-bottom: 20rpx;\n}\n\n.poster-avatar-bg {\n\twidth: 80rpx;\n\theight: 80rpx;\n\tborder-radius: 50%;\n\tbackground: linear-gradient(135deg, #e7d7a7 0%, #f7e7b7 100%);\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tmargin-right: 20rpx;\n}\n\n.avatar {\n\twidth: 64rpx;\n\theight: 64rpx;\n\tborder-radius: 50%;\n\tborder: 2rpx solid #e5e7eb;\n\tbackground: #f5f6fa;\n\tobject-fit: cover;\n}\n\n.poster-meta {\n\tflex: 1;\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n}\n\n.meta-row {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin-bottom: 8rpx;\n}\n\n.poster-name {\n\tcolor: #bfa94d;\n\tfont-size: 32rpx;\n\tfont-weight: 600;\n}\n\n.poster-tag {\n\tmargin-left: 16rpx;\n\tpadding: 2rpx 16rpx;\n\tborder-radius: 12rpx;\n\tfont-size: 22rpx;\n\tfont-weight: 500;\n\tbackground: #f7e7b7;\n\tcolor: #bfa94d;\n\t&.official {\n\t\tbackground: #f7e7b7;\n\t\tcolor: #bfa94d;\n\t}\n\t&.merchant {\n\t\tbackground: #f7e7b7;\n\t\tcolor: #bfa94d;\n\t}\n}\n\n.poster-time {\n\tcolor: #b0b6be;\n\tfont-size: 22rpx;\n\tmargin-top: 2rpx;\n}\n\n.content-body {\n\t.content-text {\n\t\tfont-size: $font-size-base;\n\t\tline-height: 1.6;\n\t\tcolor: $dark-gray;\n\t}\n\t\n\t.image-grid {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: repeat(3, 1fr);\n\t\tgap: $spacing-xs;\n\t\tmargin-top: $spacing-base;\n\t\t\n\t\timage {\n\t\t\twidth: 100%;\n\t\t\theight: 200rpx;\n\t\t\tborder-radius: $border-radius-base;\n\t\t}\n\t}\n}\n\n.interaction-bar {\n\tborder-top: 1rpx solid rgba(0, 0, 0, 0.05);\n\tborder-bottom: 1rpx solid rgba(0, 0, 0, 0.05);\n\t\n\t.interaction-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\t\n\t\t.iconfont {\n\t\t\tfont-size: $font-size-lg;\n\t\t\tcolor: $gray;\n\t\t\ttransition: all 0.3s ease;\n\t\t\t\n\t\t\t&.liked {\n\t\t\t\tcolor: #FF4D4F;\n\t\t\t}\n\t\t\t\n\t\t\t&.like-animate {\n\t\t\t\tanimation: likeAnimation 0.5s ease;\n\t\t\t}\n\t\t}\n\t\t\n\t\t.count {\n\t\t\tfont-size: $font-size-sm;\n\t\t\tcolor: $gray;\n\t\t\ttransition: color 0.3s ease;\n\t\t\t\n\t\t\t&.liked {\n\t\t\t\tcolor: #FF4D4F;\n\t\t\t}\n\t\t}\n\t}\n}\n\n@keyframes likeAnimation {\n\t0% { transform: scale(1); }\n\t50% { transform: scale(1.4); }\n\t100% { transform: scale(1); }\n}\n\n.comments-section {\n\tpadding: 0 24rpx;\n}\n\n.comment-item {\n\tbackground: #fff;\n\tborder-radius: 18rpx;\n\tbox-shadow: 0 4rpx 16rpx rgba(77,124,191,0.06);\n\tmargin-bottom: 20rpx;\n\tpadding: 24rpx 24rpx 24rpx 104rpx;\n\tposition: relative;\n\tmin-height: 88rpx;\n\t\n\t.comment-avatar {\n\t\tposition: absolute;\n\t\tleft: 24rpx;\n\t\ttop: 24rpx;\n\t\twidth: 64rpx;\n\t\theight: 64rpx;\n\t\tborder-radius: 50%;\n\t\tborder: 2rpx solid #e5e7eb;\n\t\tbackground: #f5f6fa;\n\t\tobject-fit: cover;\n\t}\n\t\n\t.comment-content {\n\t\twidth: 100%;\n\t}\n\t\n\t.comment-name {\n\t\tcolor: #4D7CBF;\n\t\tfont-size: 30rpx;\n\t\tfont-weight: 600;\n\t}\n\t\n\t.comment-text {\n\t\tcolor: #222;\n\t\tfont-size: 32rpx;\n\t\tmargin-top: 8rpx;\n\t}\n\t\n\t.comment-actions-bar {\n\t\tmargin-top: 12rpx;\n\t\tdisplay: flex;\n\t\twidth: 100%;\n\t\talign-items: center;\n\t}\n\t\n\t.left-actions {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\t\n\t.comment-time, .action-btn {\n\t\tcolor: #999;\n\t\tfont-size: 24rpx;\n\t}\n\t\n\t.action-btn {\n\t\tmargin-left: 32rpx;\n\t\tbackground: #f2f4f8;\n\t\tborder-radius: 8rpx;\n\t\tpadding: 0 12rpx;\n\t}\n\t\n\t.right-actions {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tmargin-left: auto;\n\t}\n\t\n\t.like-btn-wrapper {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\t\n\t.like-btn {\n\t\tfont-size: 36rpx;\n\t\tcolor: #b0b6be;\n\t\ttransition: color 0.2s, transform 0.2s;\n\t\t&.like-animate {\n\t\t\ttransform: scale(1.3);\n\t\t}\n\t\t&.liked {\n\t\t\tcolor: #FF4D4F;\n\t\t}\n\t}\n\t\n\t.like-count {\n\t\tfont-size: 24rpx;\n\t\tcolor: #b0b6be;\n\t\tfont-weight: 600;\n\t\tmargin-left: 8rpx;\n\t\ttransition: color 0.2s;\n\t\t&.liked {\n\t\t\tcolor: #FF4D4F;\n\t\t}\n\t}\n}\n\n.comment-input-bar {\n\tposition: fixed;\n\tbottom: 0;\n\tleft: 0;\n\tright: 0;\n\tdisplay: flex;\n\talign-items: center;\n\tbox-shadow: 0 -2rpx 10rpx rgba(77,124,191,0.06);\n\tbackground: #fff;\n\tpadding: 12rpx 24rpx 12rpx 24rpx;\n\tz-index: 100;\n\tborder-top: 1rpx solid #f0f1f3;\n\n\t.comment-input {\n\t\tflex: 1;\n\t\theight: 64rpx;\n\t\tbackground-color: #f5f6fa;\n\t\tborder-radius: 32rpx;\n\t\tpadding: 0 24rpx;\n\t\tfont-size: 30rpx;\n\t\tcolor: #222;\n\t\tborder: 1rpx solid #e5e7eb;\n\t\tbox-shadow: 0 2rpx 8rpx rgba(77,124,191,0.03);\n\t\toutline: none;\n\t\ttransition: border 0.2s, box-shadow 0.2s;\n\t}\n\t.comment-input:focus {\n\t\tborder: 1rpx solid #4D7CBF;\n\t\tbox-shadow: 0 2rpx 12rpx rgba(77,124,191,0.08);\n\t}\n\t.send-btn {\n\t\tmargin-left: 16rpx;\n\t\tpadding: 0 32rpx;\n\t\theight: 56rpx;\n\t\tline-height: 56rpx;\n\t\tbackground-color: #4D7CBF;\n\t\tcolor: #fff;\n\t\tborder-radius: 28rpx;\n\t\tfont-size: 28rpx;\n\t\tfont-weight: 600;\n\t\tborder: none;\n\t\tbox-shadow: 0 2rpx 8rpx rgba(77,124,191,0.08);\n\t\ttransition: background 0.2s, color 0.2s;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\t.send-btn:disabled {\n\t\tbackground-color: #b0b6be;\n\t\tcolor: #fff;\n\t}\n}\n\n.header {\n\tbackground-color: #fff;\n\tposition: sticky;\n\ttop: 0;\n\tz-index: 100;\n\tbox-shadow: 0 2rpx 10rpx rgba(77,124,191,0.06);\n\t.iconfont {\n\t\tfont-size: 40rpx;\n\t\tcolor: #4D7CBF;\n\t}\n}\n\n.reply-list {\n\tmargin-top: 8rpx;\n\tpadding-left: 16rpx;\n}\n.reply-item {\n\tdisplay: flex;\n\talign-items: flex-start;\n\tbackground: #fafbfc;\n\tborder-radius: 12rpx;\n\tmargin-bottom: 8rpx;\n\tpadding: 12rpx 16rpx 12rpx 12rpx;\n\tbox-shadow: 0 2rpx 8rpx rgba(77,124,191,0.02);\n}\n.reply-avatar {\n\twidth: 48rpx;\n\theight: 48rpx;\n\tborder-radius: 50%;\n\tmargin-right: 14rpx;\n\tbackground: #fff;\n}\n.reply-content {\n\tflex: 1;\n}\n.reply-name {\n\tcolor: #4D7CBF;\n\tfont-size: 26rpx;\n\tfont-weight: 500;\n}\n.reply-time {\n\tcolor: #bbb;\n\tfont-size: 22rpx;\n\tmargin-left: 10rpx;\n}\n.reply-text {\n\tcolor: #555;\n\tfont-size: 26rpx;\n\tmargin-top: 4rpx;\n\tline-height: 1.6;\n}\n\n/* 添加加载状态样式 */\n.loading-overlay {\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tbackground: rgba(255, 255, 255, 0.9);\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tz-index: 999;\n}\n\n.loading-spinner {\n\twidth: 60rpx;\n\theight: 60rpx;\n\tborder: 6rpx solid #f3f3f3;\n\tborder-top: 6rpx solid #4D7CBF;\n\tborder-radius: 50%;\n\tanimation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n\t0% { transform: rotate(0deg); }\n\t100% { transform: rotate(360deg); }\n}\n\n/* 优化列表渲染性能 */\n.comment-list {\n\twill-change: transform;\n\ttransform: translateZ(0);\n}\n\n.comment-item {\n\twill-change: transform;\n\ttransform: translateZ(0);\n\tcontain: layout style paint;\n}\n</style>\n","import MiniProgramPage from 'D:/2大花/毕业设计/Compus/pages/circle/pinned-datail/pinned-datail.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","uniCloud"],"mappings":"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"}