{"version":3,"file":"post-datail.js","sources":["pages/circle/post-datail/post-datail.vue","../../../Software/hbuilder/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2lyY2xlL3Bvc3QtZGF0YWlsL3Bvc3QtZGF0YWlsLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"post-detail-bg\">\n    <view class=\"post-detail-container\">\n      <!-- 头部卡片 -->\n      <view class=\"post-header-card\">\n        <image :src=\"post.avatar\" class=\"post-avatar\"></image>\n        <view class=\"post-info\">\n          <view class=\"post-name-row\">\n            <text class=\"post-name\">{{ post.name }}</text>\n            <text class=\"post-tag\" :class=\"post.tagClass\">{{ post.tag }}</text>\n          </view>\n          <text class=\"post-meta\">{{ post.time }}</text>\n        </view>\n      </view>\n\n      <!-- 正文内容 -->\n      <view class=\"post-content-block\">\n        <text class=\"post-content\">{{ post.content }}</text>\n        <view class=\"post-images\" v-if=\"post.images && post.images.length\">\n          <image\n            v-for=\"(img, idx) in post.images\"\n            :key=\"idx\"\n            :src=\"img\"\n            mode=\"aspectFill\"\n            class=\"post-image\"\n            @tap=\"previewImage(post.images, idx)\"\n          ></image>\n        </view>\n      </view>\n\n      <!-- 操作区 -->\n      <view class=\"post-actions\">\n        <view class=\"action-item like-btn\" :class=\"{ 'is-active': post.isLiked }\" @tap=\"likePost\">\n          <text class=\"action-icon iconfont icon-dianzan\"></text>\n          <text class=\"action-text\">{{ post.likes }}</text>\n        </view>\n        <view class=\"action-item comment-btn\" @tap=\"focusCommentInput\">\n          <text class=\"action-icon iconfont icon-icon_comment\"></text>\n          <text class=\"action-text\">{{ comments.length }}</text>\n        </view>\n        <view class=\"action-item share-btn\">\n          <text class=\"action-icon iconfont icon-fasong\"></text>\n          <text class=\"action-text\">分享</text>\n        </view>\n      </view>\n\n      <!-- 评论区 -->\n      <view class=\"comment-section\">\n        <view class=\"section-title\">\n          <text class=\"font-bold\">评论区 ({{ post.comments }})</text>\n        </view>\n        <view class=\"comment-list\">\n          <view class=\"comment-item\" v-for=\"(comment, index) in comments\" :key=\"comment._id\">\n            <image class=\"comment-avatar\" :src=\"comment.author_avatar\" mode=\"aspectFill\"></image>\n            <view class=\"comment-content\">\n              <view class=\"flex items-center\">\n                <text class=\"comment-name font-bold\">{{ comment.author_name }}</text>\n              </view>\n              <text class=\"comment-text mt-xs\">{{ comment.content }}</text>\n              <view class=\"comment-actions-bar flex mt-xs\">\n                <view class=\"left-actions flex items-center\">\n                  <text class=\"comment-time text-muted text-xs\">{{ formatTime(comment.create_time) }}</text>\n                  <text class=\"action-btn ml-base\" @tap=\"replyToComment(comment)\">回复</text>\n                </view>\n                <view class=\"right-actions flex items-center ml-auto\">\n                  <view class=\"like-btn-wrapper flex items-center\">\n                    <text class=\"iconfont like-btn\"\n                      :class=\"[comment.liked ? 'icon-aixin4 liked' : 'icon-aixin3', comment.likeAnimate ? 'like-animate' : '']\"\n                      @tap=\"likeComment(comment, index)\"></text>\n                    <text class=\"like-count ml-xs\" :class=\"{'liked': comment.liked}\">{{ comment.like_count }}</text>\n                  </view>\n                </view>\n              </view>\n              <!-- 子评论展示 -->\n              <view v-if=\"comment.replies && comment.replies.length\" class=\"reply-list\">\n                <view class=\"reply-item\" v-for=\"(reply, rIdx) in comment.replies\" :key=\"reply._id\">\n                  <image class=\"reply-avatar\" :src=\"reply.author_avatar\" mode=\"aspectFill\"></image>\n                  <view class=\"reply-content\">\n                    <view class=\"flex items-center\">\n                      <text class=\"reply-name\">{{ reply.author_name }}</text>\n                      <text class=\"reply-time ml-xs\">{{ formatTime(reply.create_time) }}</text>\n                    </view>\n                    <text class=\"reply-text mt-xs\">{{ reply.content }}</text>\n                  </view>\n                </view>\n              </view>\n            </view>\n          </view>\n        </view>\n      </view>\n    </view>\n    <!-- 评论输入框 -->\n    <view class=\"comment-input-bar\">\n      <image :src=\"userInfo.avatar_file && userInfo.avatar_file.url ? userInfo.avatar_file.url : '/static/images/default-avatar.png'\" class=\"input-avatar\"></image>\n      <input class=\"comment-input\" v-model=\"commentText\" :placeholder=\"replyPlaceholder\" :focus=\"isInputFocused\" @focus=\"onInputFocus\" @blur=\"onInputBlur\" />\n      <button class=\"send-btn\" :disabled=\"!commentText.trim()\" @tap=\"sendComment\">发送</button>\n    </view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      post: {},\n      comments: [],\n      commentText: '',\n      isInputFocused: false,\n      likeLoading: false,\n      userInfo: uni.getStorageSync('uni-id-pages-userInfo') || {},\n      replyTo: null, // 当前回复的评论对象\n      replyPlaceholder: '说点什么...'\n    }\n  },\n  onLoad(options) {\n    const postId = options.id;\n    this.loadPostDetail(postId);\n    this.fetchComments(postId);\n  },\n  methods: {\n    // 获取帖子详情+用户信息+点赞状态\n    async loadPostDetail(postId) {\n      try {\n        // 1. 获取帖子详情\n        const postRes = await uniCloud.database().collection('add-content').doc(postId).get();\n        if (!postRes.result.data || postRes.result.data.length === 0) {\n          uni.showToast({ title: '未找到该帖子', icon: 'none' });\n          return;\n        }\n        const post = postRes.result.data[0];\n\n        // 2. 获取发帖人信息\n        let user = {};\n        try {\n          const userRes = await uniCloud.database().collection('uni-id-users')\n            .doc(post.user_id)\n            .field('_id,avatar_file,nickname')\n            .get();\n          user = userRes.result.data[0] || {};\n        } catch (e) {}\n\n        // 3. 获取当前用户是否已点赞\n        let isLiked = false;\n        if (this.userInfo && this.userInfo._id) {\n          const likeRes = await uniCloud.database().collection('user-likes')\n            .where({\n              user_id: this.userInfo._id,\n              post_id: postId\n            })\n            .get();\n          isLiked = likeRes.result.data.length > 0;\n        }\n\n        // 4. 组装数据\n        this.post = {\n          _id: post._id,\n          content: post.content,\n          images: post.files || [],\n          likes: post.like_count || 0,\n          comments: post.comment_count || 0,\n          time: this.formatTime(post.create_time),\n          name: user.nickname || '匿名用户',\n          avatar: user.avatar_file && user.avatar_file.url ? user.avatar_file.url : '/static/images/default-avatar.png',\n          tag: post.category,\n          tagClass: this.getTagClass(post.category),\n          isLiked\n        };\n      } catch (e) {\n        uni.showToast({ title: '加载失败', icon: 'none' });\n      }\n    },\n    // 帖子点赞/取消点赞\n    async likePost() {\n      if (this.likeLoading) return;\n      this.likeLoading = true;\n\n      if (!this.userInfo || !this.userInfo._id) {\n        uni.showToast({ title: '请先登录', icon: 'none' });\n        this.likeLoading = false;\n        return;\n      }\n      const userId = this.userInfo._id;\n      const postId = this.post._id;\n\n      if (this.post.isLiked) {\n        // 取消点赞\n        try {\n          // 查找点赞记录\n          const likeRes = await uniCloud.database().collection('user-likes')\n            .where({ user_id: userId, post_id: postId })\n            .get();\n          if (likeRes.result.data.length > 0) {\n            const likeId = likeRes.result.data[0]._id;\n            await uniCloud.database().collection('user-likes').doc(likeId).remove();\n            await uniCloud.database().collection('add-content').doc(postId).update({\n              like_count: this.post.likes - 1\n            });\n            this.post.isLiked = false;\n            this.post.likes -= 1;\n            uni.showToast({ title: '已取消点赞', icon: 'none' });\n          }\n        } catch (e) {\n          uni.showToast({ title: '操作失败', icon: 'none' });\n        }\n      } else {\n        // 点赞\n        try {\n          await uniCloud.database().collection('user-likes').add({\n            user_id: userId,\n            post_id: postId,\n            create_time: Date.now()\n          });\n          await uniCloud.database().collection('add-content').doc(postId).update({\n            like_count: this.post.likes + 1\n          });\n          this.post.isLiked = true;\n          this.post.likes += 1;\n          uni.showToast({ title: '已点赞', icon: 'none' });\n        } catch (e) {\n          uni.showToast({ title: '操作失败', icon: 'none' });\n        }\n      }\n      this.likeLoading = false;\n    },\n    formatTime(ts) {\n      const date = new Date(ts);\n      const now = Date.now();\n      const diff = now - new Date(ts).getTime();\n      if (diff < 60000) return '刚刚';\n      if (diff < 3600000) return Math.floor(diff / 60000) + '分钟前';\n      if (diff < 86400000) return Math.floor(diff / 3600000) + '小时前';\n      return `${date.getFullYear()}-${date.getMonth()+1}-${date.getDate()} ${date.getHours()}:${date.getMinutes()}`;\n    },\n    getTagClass(category) {\n      if (category === '讨论') return 'discussion';\n      if (category === '失物招领') return 'lost';\n      if (category === '问答') return 'question';\n      return '';\n    },\n    async fetchComments(postId) {\n      const res = await uniCloud.database().collection('user-comment')\n        .where({ target_id: postId })\n        .orderBy('create_time', 'asc')\n        .get();\n      const all = res.result.data;\n\n      // 获取所有评论id\n      const commentIds = all.map(item => item._id);\n      let likedMap = {};\n      if (this.userInfo && this.userInfo._id && commentIds.length) {\n        const likeRes = await uniCloud.database().collection('user-commentlikes')\n          .where({\n            user_id: this.userInfo._id,\n            comment_id: uniCloud.database().command.in(commentIds)\n          })\n          .get();\n        likedMap = {};\n        likeRes.result.data.forEach(like => {\n          likedMap[like.comment_id] = true;\n        });\n      }\n\n      // 一级评论\n      const top = all.filter(c => !c.parent_id).map(item => ({\n        ...item,\n        liked: likedMap[item._id] || false\n      }));\n      // 二级评论分组\n      top.forEach(parent => {\n        parent.replies = all.filter(c => c.parent_id === parent._id).map(item => ({\n          ...item,\n          liked: likedMap[item._id] || false\n        }));\n      });\n      this.comments = top;\n    },\n    previewImage(images, index) {\n      uni.previewImage({\n        urls: images,\n        current: images[index]\n      });\n    },\n    //点赞评论\n    async likeComment(comment, idx) {\n      if (!this.userInfo || !this.userInfo._id) {\n        uni.showToast({ title: '请先登录', icon: 'none' });\n        return;\n      }\n      const userId = this.userInfo._id;\n      const commentId = comment._id;\n\n      // 先查是否已点赞\n      const likeRes = await uniCloud.database().collection('user-commentlikes')\n        .where({ user_id: userId, comment_id: commentId })\n        .get();\n\n      if (likeRes.result.data.length > 0) {\n        // 已点赞，执行取消点赞\n        const likeId = likeRes.result.data[0]._id;\n        await uniCloud.database().collection('user-commentlikes').doc(likeId).remove();\n        await uniCloud.database().collection('user-comment').doc(commentId).update({\n          like_count: Math.max(0, comment.like_count - 1)\n        });\n        this.comments[idx].like_count = Math.max(0, this.comments[idx].like_count - 1);\n        this.comments[idx].liked = false;\n        uni.showToast({ title: '已取消点赞', icon: 'none' });\n      } else {\n        // 未点赞，执行点赞\n        await uniCloud.database().collection('user-commentlikes').add({\n          user_id: userId,\n          comment_id: commentId,\n          create_time: Date.now()\n        });\n        await uniCloud.database().collection('user-comment').doc(commentId).update({\n          like_count: comment.like_count + 1\n        });\n        this.comments[idx].like_count += 1;\n        this.comments[idx].liked = true;\n        uni.showToast({ title: '已点赞', icon: 'none' });\n      }\n    },\n    focusCommentInput() {\n      this.isInputFocused = true;\n    },\n    onInputFocus() {\n      this.isInputFocused = true;\n    },\n    onInputBlur() {\n      this.isInputFocused = false;\n    },\n    replyToComment(comment) {\n      this.replyTo = comment;\n      this.replyPlaceholder = `回复 @${comment.author_name}：`;\n      this.isInputFocused = true;\n    },\n    //发送评论\n    async sendComment() {\n      if (!this.commentText.trim()) return;\n      if (!this.userInfo._id) {\n        uni.showToast({ title: '请先登录', icon: 'none' });\n        return;\n      }\n      const postId = this.post._id;\n      await uniCloud.callFunction({\n        name: 'user-comment',\n        data: {\n          content: this.commentText,\n          author_id: this.userInfo._id,\n          author_name: this.userInfo.nickname || '匿名用户',\n          author_avatar: this.userInfo.avatar_file && this.userInfo.avatar_file.url ? this.userInfo.avatar_file.url : '/static/images/default-avatar.png',\n          target_id: postId,\n          parent_id: this.replyTo ? this.replyTo._id : ''\n        }\n      });\n      this.commentText = '';\n      this.isInputFocused = false;\n      this.replyTo = null;\n      this.replyPlaceholder = '说点什么...';\n      uni.showToast({ title: '评论成功', icon: 'none' });\n      this.fetchComments(postId);\n      this.post.comments += 1;\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n@import '@/styles/variables.scss';\n\n.post-detail-bg {\n  min-height: 100vh;\n  background: #f8f9fc;\n  padding-bottom: 120rpx;\n}\n.post-detail-container {\n  margin: 32rpx 0;\n  padding: 0 24rpx 24rpx 24rpx;\n}\n.post-header-card {\n  display: flex;\n  align-items: center;\n  background: $white;\n  border-radius: 18rpx;\n  box-shadow: 0 4rpx 16rpx rgba(77,124,191,0.08);\n  padding: 24rpx;\n  margin-bottom: 24rpx;\n}\n.post-avatar {\n  width: 80rpx;\n  height: 80rpx;\n  border-radius: 50%;\n  border: 2rpx solid #e5e7eb;\n  background: #f5f6fa;\n  margin-right: 20rpx;\n}\n.post-info {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n.post-name-row {\n  display: flex;\n  align-items: center;\n  margin-bottom: 8rpx;\n}\n.post-name {\n  font-size: 32rpx;\n  font-weight: 600;\n  color: $dark-gray;\n  margin-right: 16rpx;\n}\n.post-tag {\n  padding: 4rpx 16rpx;\n  border-radius: 12rpx;\n  font-size: 22rpx;\n  font-weight: 500;\n  background: rgba($primary-color, 0.1);\n  color: $primary-color;\n  &.discussion { background: rgba($primary-color, 0.1); color: $primary-color; }\n  &.question { background: rgba($warning-color, 0.1); color: $warning-color; }\n  &.lost { background: rgba($error-color, 0.1); color: $error-color; }\n  &.pin { background: rgba($success-color, 0.1); color: $success-color; }\n  &.official { background: rgba($info-color, 0.1); color: $info-color; }\n  &.promotion { background: rgba($purple-color, 0.1); color: $purple-color; }\n}\n.post-meta {\n  font-size: 22rpx;\n  color: $gray;\n}\n.post-content-block {\n  background: $white;\n  border-radius: 16rpx;\n  padding: 32rpx 24rpx 24rpx 24rpx;\n  margin-bottom: 24rpx;\n  box-shadow: 0 2rpx 8rpx rgba(77,124,191,0.04);\n}\n.post-content {\n  font-size: 30rpx;\n  color: $dark-gray;\n  line-height: 1.8;\n  margin-bottom: 24rpx;\n  display: block;\n}\n.post-images {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 12rpx;\n  .post-image {\n    width: calc(33.33% - 8rpx);\n    height: 200rpx;\n    border-radius: 12rpx;\n    background-color: $bg-color;\n    object-fit: cover;\n  }\n}\n.post-actions {\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n  background: $white;\n  border-radius: 16rpx;\n  box-shadow: 0 2rpx 8rpx rgba(77,124,191,0.04);\n  padding: 18rpx 0;\n  margin-bottom: 24rpx;\n  .action-item {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 32rpx;\n    padding: 8rpx 32rpx;\n    font-size: 28rpx;\n    transition: all $transition-fast;\n    .action-icon {\n      font-size: 36rpx;\n      margin-right: 10rpx;\n      color: $gray;\n      transition: all $transition-fast;\n    }\n    .action-text {\n      font-size: 26rpx;\n      color: $gray;\n    }\n    &.like-btn.is-active .action-icon {\n      color: $error-color;\n      animation: likeAnimation 0.5s ease;\n    }\n    &:active {\n      background: $bg-color-hover;\n      transform: scale(0.96);\n    }\n  }\n}\n.comment-section {\n  padding: 0 24rpx;\n  .section-title {\n    font-size: 28rpx;\n    font-weight: 600;\n    color: $primary-color;\n    margin-bottom: 18rpx;\n    padding: 24rpx 0 0 0;\n  }\n}\n.comment-list {\n  margin-top: 0;\n}\n.comment-item {\n  background: #fff;\n  border-radius: 18rpx;\n  box-shadow: 0 4rpx 16rpx rgba(77,124,191,0.06);\n  margin-bottom: 20rpx;\n  padding: 24rpx 24rpx 24rpx 104rpx;\n  position: relative;\n  min-height: 88rpx;\n  .comment-avatar {\n    position: absolute;\n    left: 24rpx;\n    top: 24rpx;\n    width: 64rpx;\n    height: 64rpx;\n    border-radius: 50%;\n    border: 2rpx solid #e5e7eb;\n    background: #f5f6fa;\n    object-fit: cover;\n  }\n  .comment-content {\n    width: 100%;\n  }\n  .comment-name {\n    color: #4D7CBF;\n    font-size: 30rpx;\n    font-weight: 600;\n  }\n  .comment-text {\n    color: #222;\n    font-size: 32rpx;\n    margin-top: 8rpx;\n  }\n  .comment-actions-bar {\n    margin-top: 12rpx;\n    display: flex;\n    width: 100%;\n    align-items: center;\n  }\n  .left-actions {\n    display: flex;\n    align-items: center;\n  }\n  .comment-time, .action-btn {\n    color: #999;\n    font-size: 24rpx;\n  }\n  .action-btn {\n    margin-left: 32rpx;\n    background: #f2f4f8;\n    border-radius: 8rpx;\n    padding: 0 12rpx;\n  }\n  .right-actions {\n    display: flex;\n    align-items: center;\n    margin-left: auto;\n  }\n  .like-btn-wrapper {\n    display: flex;\n    align-items: center;\n  }\n  .like-btn {\n    font-size: 36rpx;\n    color: #b0b6be;\n    transition: color 0.2s, transform 0.2s;\n    &.like-animate {\n      transform: scale(1.3);\n    }\n    &.liked {\n      color: #FF4D4F;\n    }\n  }\n  .like-count {\n    font-size: 24rpx;\n    color: #b0b6be;\n    font-weight: 600;\n    margin-left: 8rpx;\n    transition: color 0.2s;\n    &.liked {\n      color: #FF4D4F;\n    }\n  }\n}\n.reply-list {\n  margin-top: 8rpx;\n  padding-left: 16rpx;\n}\n.reply-item {\n  display: flex;\n  align-items: flex-start;\n  background: #fafbfc;\n  border-radius: 12rpx;\n  margin-bottom: 8rpx;\n  padding: 12rpx 16rpx 12rpx 12rpx;\n  box-shadow: 0 2rpx 8rpx rgba(77,124,191,0.02);\n  .reply-avatar {\n    width: 48rpx;\n    height: 48rpx;\n    border-radius: 50%;\n    margin-right: 14rpx;\n    background: #fff;\n  }\n  .reply-content {\n    flex: 1;\n  }\n  .reply-name {\n    color: #4D7CBF;\n    font-size: 26rpx;\n    font-weight: 500;\n  }\n  .reply-time {\n    color: #bbb;\n    font-size: 22rpx;\n    margin-left: 10rpx;\n  }\n  .reply-text {\n    color: #555;\n    font-size: 26rpx;\n    margin-top: 4rpx;\n    line-height: 1.6;\n  }\n}\n.comment-input-bar {\n  position: fixed;\n  left: 0;\n  bottom: 0;\n  width: 100vw;\n  background: $white;\n  box-shadow: 0 -2rpx 8rpx rgba(77,124,191,0.06);\n  display: flex;\n  align-items: center;\n  padding: 16rpx 24rpx;\n  z-index: 99;\n}\n.input-avatar {\n  width: 48rpx;\n  height: 48rpx;\n  border-radius: 50%;\n  margin-right: 12rpx;\n  background: #f5f6fa;\n  border: 1rpx solid #e5e7eb;\n}\n.comment-input {\n  flex: 1;\n  height: 64rpx;\n  border-radius: 32rpx;\n  background: #f5f6fa;\n  border: none;\n  padding: 0 24rpx;\n  font-size: 26rpx;\n  margin-right: 16rpx;\n}\n.send-btn {\n  background: $primary-color;\n  color: $white;\n  border: none;\n  border-radius: 32rpx;\n  font-size: 26rpx;\n  padding: 0 32rpx;\n  height: 64rpx;\n  line-height: 64rpx;\n  transition: all $transition-fast;\n  &:disabled {\n    background: $gray;\n    color: #fff;\n    opacity: 0.5;\n  }\n}\n@keyframes likeAnimation {\n  0% { transform: scale(1);}\n  50% { transform: scale(1.4);}\n  100% { transform: scale(1);}\n}\n</style>","import MiniProgramPage from 'D:/2大花/毕业设计/Compus/pages/circle/post-datail/post-datail.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","uniCloud"],"mappings":"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"}